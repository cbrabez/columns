<% include ../partials/header %>
  
<main role="main" class="container">
  <div class="tasks">
   <h1>Index | Tasks</h1>
   <ul class="list-group" id="taskList">
      <% tasks.forEach(function(task){ %>
     <li class="list-group-item" draggable="true" data-id="<%= task.id %>"><%= task.title %>
        <span class="delete-task float-right"><a><i class="fi-x"></i></a></span>
     </li>
      <% }); %>
   </ul>
  </div>
  <div class="input-group input-group-sm mb-3">
  <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="add new Task">
</div>

</main><!-- /.container -->
<script>
$("ul#taskList").sortable({
    pull: 'clone',
    animation: 150,
     onEnd: function (/**Event*/evt) {
		var itemEl = evt.item;  // dragged HTMLElement
		evt.to;    // target list
		evt.from;  // previous list
		evt.oldIndex;  // element's old index within old parent
		var listPosition = evt.newIndex;  // element's new index within new parent
		var name = itemEl.innerHTML;
		var taskId = itemEl.getAttribute("data-id");
		$.ajax({
            method: "POST",
            url: "/tasks/" + taskId + "/?_method=PUT",
            data: {name: name, listPosition: listPosition},
            success: function(result) {
                
            }
        });
	},
});
</script>

<% include ../partials/footer %>